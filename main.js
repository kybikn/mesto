/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t={};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(){r=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,a=Object.create(o.prototype),u=new P(n||[]);return i(a,"_invoke",{value:k(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var h={};function y(){}function d(){}function v(){}var m={};s(m,u,(function(){return this}));var _=Object.getPrototypeOf,b=_&&_(_(j([])));b&&b!==n&&o.call(b,u)&&(m=b);var g=v.prototype=y.prototype=Object.create(m);function S(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,r){function n(i,a,u,c){var l=p(t[i],t,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==e(f)&&o.call(f,"__await")?r.resolve(f.__await).then((function(t){n("next",t,u,c)}),(function(t){n("throw",t,u,c)})):r.resolve(f).then((function(t){s.value=t,u(s)}),(function(t){return n("throw",t,u,c)}))}c(l.arg)}var a;i(this,"_invoke",{value:function(t,e){function o(){return new r((function(r,o){n(t,e,r,o)}))}return a=a?a.then(o,o):o()}})}function k(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=E(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=p(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function E(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var o=p(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,h;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function j(t){if(t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:C}}function C(){return{value:void 0,done:!0}}return d.prototype=v,i(g,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:d,configurable:!0}),d.displayName=s(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,s(t,l,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},S(w.prototype),s(w.prototype,c,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(g),s(g,l,"Generator"),s(g,u,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function o(t,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}t.p="";var i=function(){function t(e,r,n,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e.name,this._link=e.link,this._id=e._id,this._likes=e.likes,this._like=e.like,this._isOwner=e.isOwner,this._imgSelector=r.imgSelector,this._titleSelector=r.titleSelector,this._likeButtonSelector=r.likeButtonSelector,this._likesNumSelector=r.likesNumSelector,this._activeButtonClass=r.activeButtonClass,this._removeButtonSelector=r.removeButtonSelector,this._templateSelector=r.templateSelector,this._cardSelector=r.cardSelector,this._cardPopup=document.querySelector(r.cardPopupSelector),this._handleCardClick=n,this._apiCallbacks=o,this._confPopupCallbacks=i,this._removeCard=this._removeCard.bind(this),this._notFoundImg=r.notFoundImg}var e,i,a,u;return e=t,i=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(this._cardSelector).cloneNode(!0)}},{key:"_setElements",value:function(){this._cardName=this._newCard.querySelector(this._titleSelector),this._cardImage=this._newCard.querySelector(this._imgSelector),this._cardLike=this._newCard.querySelector(this._likeButtonSelector),this._buttonRemove=this._newCard.querySelector(this._removeButtonSelector),this._likesNum=this._newCard.querySelector(this._likesNumSelector)}},{key:"_imageExists",value:(a=r().mark((function t(e){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",!1);case 2:return t.abrupt("return",new Promise((function(t){var r=new Image;r.onload=function(){return t(!0)},r.onerror=function(){return t(!1)},r.src=e})));case 3:case"end":return t.stop()}}),t)})),u=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=a.apply(t,e);function u(t){n(i,r,o,u,c,"next",t)}function c(t){n(i,r,o,u,c,"throw",t)}u(void 0)}))},function(t){return u.apply(this,arguments)})},{key:"_setData",value:function(){var t=this;this._cardName.textContent=this._name,this._imageExists(this._link).then((function(e){e||(console.log("Image for card ".concat(t._name," not found, so will be used 'notfound.jpg' image instead")),t._link=t._notFoundImg),t._cardImage.src=t._link,t._cardImage.alt=t._link})).catch((function(t){return console.log(t)}))}},{key:"_removeCard",value:function(){var t=this;this._apiCallbacks.deleteCard(this._id).then((function(e){e&&(t._newCard.remove(),t._newCard=null)})).catch((function(t){return console.log(t)}))}},{key:"_handleToggleLikeWithApi",value:function(){var t=this;this._cardLike.classList.contains(this._activeButtonClass)?this._apiCallbacks.deleteLike(this._id).then((function(e){t._likes=e.likes,t._setLikes(),t._handleDeleteLike()})).catch((function(t){return console.log(t)})):this._apiCallbacks.addLike(this._id).then((function(e){t._likes=e.likes,t._setLikes(),t._handleAddLike()})).catch((function(t){return console.log(t)}))}},{key:"_handleAddLike",value:function(){this._cardLike.classList.add(this._activeButtonClass)}},{key:"_handleDeleteLike",value:function(){this._cardLike.classList.remove(this._activeButtonClass)}},{key:"_setEventListeners",value:function(){var t=this;this._buttonRemove.addEventListener("click",(function(){t._confPopupCallbacks.addNext(t._removeCard),t._confPopupCallbacks.open()})),this._cardLike.addEventListener("click",(function(){return t._handleToggleLikeWithApi()})),this._cardImage.addEventListener("click",(function(){t._handleCardClick(t._name,t._link)}))}},{key:"generateCard",value:function(){return this._newCard=this._getTemplate(),this._setElements(),this._like&&this._handleAddLike(),this._isOwner||this._buttonRemove.remove(),this._setData(),this._setEventListeners(),this._setLikes(),this._newCard}},{key:"_setLikes",value:function(){var t=this._likes.length;this._likesNum.textContent=t}}],i&&o(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===a(o)?o:String(o)),n)}var o}var c=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._formElement=r,this._inputList=Array.from(r.querySelectorAll(e.inputSelector)),this._buttonElement=this._formElement.querySelector(e.submitButtonSelector)}var e,r;return e=t,(r=[{key:"_checkInputValidity",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}},{key:"checkFormValidity",value:function(){var t=this;this._inputList.forEach((function(e){t._checkInputValidity(e)})),this._toggleButtonState()}},{key:"resetValidation",value:function(){var t=this;this._inputList.forEach((function(e){e.value="",t._hideInputError(e)})),this.disableButton()}},{key:"_showInputError",value:function(t){t.classList.add(this._inputErrorClass);var e=this._formElement.querySelector(".".concat(t.id,"-error"));e.textContent=t.validationMessage,e.classList.add(this._inputErrorClass)}},{key:"_hideInputError",value:function(t){t.classList.remove(this._inputErrorClass);var e=this._formElement.querySelector(".".concat(t.id,"-error"));e.classList.remove(this._inputErrorClass),e.textContent=""}},{key:"_hasInvalidInput",value:function(t){return t.some((function(t){return!t.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput(this._inputList)?this.disableButton():this._enableButton()}},{key:"disableButton",value:function(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0}},{key:"_enableButton",value:function(){this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1}},{key:"_setEventListeners",value:function(){var t=this;this._toggleButtonState(),this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t._toggleButtonState()})),t._formElement.querySelector(".".concat(e.id,"-close")).addEventListener("click",(function(){e.value="",t._checkInputValidity(e),t._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&u(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==l(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===l(o)?o:String(o)),n)}var o}var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popupSelector=e,this._popup=document.querySelector(e),this._activePopupClass="popup_active",this._closeButtonClass="popup__close",this._handleEscClose=this._handleEscClose.bind(this),this._handleClosePopup=this._handleClosePopup.bind(this)}var e,r;return e=t,(r=[{key:"open",value:function(){this._popup.classList.add(this._activePopupClass),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove(this._activePopupClass),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleClosePopup",value:function(t){(t.target.classList.contains(this._activePopupClass)||t.target.classList.contains(this._closeButtonClass))&&this.close(this._popup)}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close(this._popup)}},{key:"setEventListeners",value:function(){var t=this;this._popup.addEventListener("click",(function(e){return t._handleClosePopup(e)}))}}])&&s(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==p(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===p(o)?o:String(o)),n)}var o}function y(){return y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=d(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},y.apply(this,arguments)}function d(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_(t)););return t}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function m(t,e){if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_(n);if(o){var r=_(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return m(this,t)});function a(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t))._submitHandler=e,n._form=n._popup.querySelector(r.formSelector),n._submitButton=n._popup.querySelector(r.submitButtonSelector),n._inputList=Array.from(n._form.querySelectorAll(r.inputSelector)),n}return e=a,r=[{key:"_getInputValues",value:function(){var t={};return this._inputList.forEach((function(e){return t[e.name]=e.value})),t}},{key:"setInputValues",value:function(t){this._inputList.forEach((function(e){e.value=t[e.name]}))}},{key:"setEventListeners",value:function(){var t=this;y(_(a.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",(function(e){var r=t._getInputValues();t._submitHandler(e,r)}))}},{key:"renderLoading",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Сохранить";this._submitButton.textContent=t?"Сохранение...":e}},{key:"close",value:function(){y(_(a.prototype),"close",this).call(this),this._form.reset()}}],r&&h(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(f);function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function S(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==g(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===g(o)?o:String(o)),n)}var o}function w(){return w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=k(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},w.apply(this,arguments)}function k(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=O(t)););return t}function E(t,e){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},E(t,e)}function L(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=O(n);if(o){var r=O(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return L(this,t)});function a(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t))._popupImg=document.querySelector(e),n._popupImgTitle=document.querySelector(r),n}return e=a,(r=[{key:"open",value:function(t,e){w(O(a.prototype),"open",this).call(this),this._popupImg.src=e,this._popupImg.alt=t,this._popupImgTitle.textContent=t}}])&&S(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(f);function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==j(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===j(o)?o:String(o)),n)}var o}var x=function(){function t(e,r){var n=e.items,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._renderedItems=n,this._renderer=o,this._container=document.querySelector(r)}var e,r;return e=t,(r=[{key:"renderItems",value:function(t){var e=this;t.reverse().forEach((function(t){e.addItem(e._renderer(t))}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&C(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function I(t){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I(t)}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==I(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===I(o)?o:String(o)),n)}var o}var B=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=document.querySelector(e),this._job=document.querySelector(r),this._avatar=document.querySelector(n)}var e,r;return e=t,(r=[{key:"getUserInfo",value:function(){return{userName:this._name.textContent,userJob:this._job.textContent}}},{key:"setUserInfo",value:function(t){this._name.textContent=t.userName,this._job.textContent=t.userJob}},{key:"setUserAvatar",value:function(t){this._avatar.src=t}},{key:"setUserId",value:function(t){this.id=t}}])&&T(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==R(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===R(o)?o:String(o)),n)}var o}var q=function(){function t(e){var r=e.baseUrl,n=e.headers;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=r,this._headers=n,this._profileUrl="".concat(r,"/users/me"),this._cardsUrl="".concat(r,"/cards")}var e,r;return e=t,(r=[{key:"_handleResponse",value:function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status," ").concat(t.statusText))}},{key:"getInitialCards",value:function(){return fetch(this._cardsUrl,{headers:this._headers,method:"GET"}).then(this._handleResponse)}},{key:"getProfile",value:function(){return fetch(this._profileUrl,{headers:this._headers,method:"GET"}).then(this._handleResponse)}},{key:"editProfile",value:function(t){var e=t.userName,r=t.userJob;return fetch(this._profileUrl,{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e,about:r})}).then(this._handleResponse)}},{key:"editAvatar",value:function(t){var e="".concat(this._profileUrl,"/avatar");return fetch(e,{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:t})}).then(this._handleResponse)}},{key:"addNewCard",value:function(t){var e=t.name,r=t.link;return fetch(this._cardsUrl,{headers:this._headers,method:"POST",body:JSON.stringify({name:e,link:r})}).then(this._handleResponse)}},{key:"deleteCard",value:function(t){var e="".concat(this._cardsUrl,"/").concat(t);return fetch(e,{headers:this._headers,method:"DELETE"}).then(this._handleResponse)}},{key:"addLike",value:function(t){var e="".concat(this._cardsUrl,"/").concat(t,"/likes");return fetch(e,{headers:this._headers,method:"PUT"}).then(this._handleResponse)}},{key:"deleteLike",value:function(t){var e="".concat(this._cardsUrl,"/").concat(t,"/likes");return console.log("likeCardsUrl:",e),fetch(e,{headers:this._headers,method:"DELETE"}).then(this._handleResponse)}}])&&N(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==U(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==U(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===U(o)?o:String(o)),n)}var o}function D(){return D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=V(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},D.apply(this,arguments)}function V(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=G(t)););return t}function F(t,e){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},F(t,e)}function J(t,e){if(e&&("object"===U(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function G(t){return G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},G(t)}var H=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=G(n);if(o){var r=G(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return J(this,t)});function a(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,t))._submitHandler=e,n._form=n._popup.querySelector(r.formSelector),n}return e=a,(r=[{key:"addNext",value:function(t){this.next=t}},{key:"setEventListeners",value:function(){var t=this;D(G(a.prototype),"setEventListeners",this).call(this),this._popup.addEventListener("submit",(function(e){e.preventDefault(),t._submitHandler(e,t.next)}))}}])&&A(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(f),M={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input-error",formProfileSelector:".popup__form-profile"},W={imgSelector:".card__img",titleSelector:".card__title",likeButtonSelector:".card__button-like",likesNumSelector:".card__num-likes",activeButtonClass:"card__button-like_active",removeButtonSelector:".card__button-remove",templateSelector:"#card",cardSelector:".card",cardPopupSelector:".popup_type_photo",notFoundImg:t.p+"032363e755d7864395b3.jpg"},Y=document.querySelector(".profile__button-edit"),z=document.querySelector(".profile__button-add"),$=document.querySelector(".profile__avatar-box"),K=document.querySelector(".popup__form-profile"),Q=document.querySelector(".popup__form-place"),X=document.querySelector(".popup__form-avatar");function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}document.querySelector(".popup__form-delete"),document.querySelector(".gallery__list"),document.querySelector(".popup__close");var tt=new b(".popup_type_profile",(function(t,e){t.preventDefault();var r=t.submitter.textContent;tt.renderLoading(!0,r);var n={userName:e.name,userJob:e.job};st.editProfile(n).then((function(){ct.setUserInfo(n),tt.close()})).catch((function(t){console.log(t)})).finally((function(){return tt.renderLoading(!1,r)}))}),M),et=new b(".popup_type_place",(function(t,e){t.preventDefault();var r={name:e.place,link:e.url},n=t.submitter.textContent;et.renderLoading(!0,n),st.addNewCard(r).then((function(t){var e=ft(pt(t,ct.id));lt.addItem(e),et.close()})).catch((function(t){return console.log(t)})).finally((function(){return et.renderLoading(!1,n)}))}),M),rt=new P(".popup_type_photo",".popup__img",".popup__img-title"),nt=new b(".popup_type_avatar",(function(t,e){t.preventDefault();var r=t.submitter.textContent;nt.renderLoading(!0,r);var n=e.link;st.editAvatar(n).then((function(){ct.setUserAvatar(n),nt.close()})).catch((function(t){console.log(t)})).finally((function(){return nt.renderLoading(!1,r)}))}),M),ot=new H(".popup_type_delete",(function(t,e){t.preventDefault(),e(),ot.close()}),M),it=new c(M,K);it.enableValidation();var at=new c(M,Q);at.enableValidation();var ut=new c(M,X);ut.enableValidation();var ct,lt,st=new q({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-58",headers:{authorization:"7b00e02a-3f2c-4bad-82e7-40e09900d10e","Content-Type":"application/json"}});function ft(t){var e={deleteCard:st.deleteCard.bind(st),addLike:st.addLike.bind(st),deleteLike:st.deleteLike.bind(st)},r={open:ot.open.bind(ot),addNext:ot.addNext.bind(ot)};return new i(t,W,ht,e,r).generateCard()}function pt(t,e){var r=JSON.parse(JSON.stringify(t));return e===r.owner._id?r.isOwner=!0:r.isOwner=!1,r.likes.some((function(t){return t._id===e}))?r.like=!0:r.like=!1,r}function ht(t,e){rt.open(t,e)}Promise.all([st.getProfile(),st.getInitialCards()]).then((function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(e,r)||function(t,e){if(t){if("string"==typeof t)return Z(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],i=n[1];(ct=new B(".profile__title",".profile__subtitle",".profile__avatar-img")).setUserInfo({userName:o.name,userJob:o.about}),ct.setUserAvatar(o.avatar),ct.setUserId(o._id);var a=i.map((function(t){return pt(t,ct.id)}));(lt=new x({items:a,renderer:ft},".gallery__list")).renderItems(a)})).catch((function(t){console.log(t)})),z.addEventListener("click",(function(){at.resetValidation(),et.open()})),Y.addEventListener("click",(function(){!function(t,e){var r=t.getUserInfo(),n={name:r.userName,job:r.userJob};e.setInputValues(n)}(ct,tt),tt.open(),it.checkFormValidity()})),$.addEventListener("click",(function(){ut.resetValidation(),nt.open()})),et.setEventListeners(),tt.setEventListeners(),rt.setEventListeners(),nt.setEventListeners(),ot.setEventListeners()})();
//# sourceMappingURL=main.js.map